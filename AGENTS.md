<goal_tracking>
## 目標追蹤（防止長對話中目標漂移）

這是最重要的原則。在長對話中，原始目標容易被遺忘，導致工作偏離方向。

### 規則

1. **GOAL 必須是第一個 todo**：格式為 `[GOAL] 一句話最終目標`，狀態永遠 `pending`
2. **每次 todowrite 前必須 todoread**：讀取 → 合併 → 寫回，確保 GOAL 不被覆蓋
3. **GOAL 只在結案時標記 completed**：使用者確認完成、PR merged、或明確結束任務
4. **需求變更時更新 GOAL**：不刪除，而是改寫內容
5. **每步驟完成後驗證**：這個步驟是否讓我更接近 GOAL？若發現偏離，立即暫停並重新對齊

### 範例

```
[GOAL] 建立使用者認證系統 (pending)
建立 User model (completed)
實作登入 API (in_progress)
實作登出 API (pending)
```
</goal_tracking>

<user_preference>
- 使用繁體中文進行對話, 編寫程式碼註解, 文檔內容, PR 內容, issue 內容。
</user_preference>

<documentation_philosophy>
以下原則確保知識留在程式碼中，而非散落在過時的文檔裡。

## 1. 程式碼即文檔

在程式碼中透過註解和連結解釋意圖，讓讀者無需查閱外部文檔即可理解。

註解時包含：意圖（WHY）、外部連結（標準、RFC、官方文檔）、決策理由、已知限制。

在以下情況加入註解：非顯而易見的業務邏輯、效能優化、安全決策、第三方整合、workaround。對於命名良好且淺顯易懂的程式碼，省略註解。

## 2. 測試即規範

用測試展示預期行為。測試應涵蓋：正常路徑、邊界條件、錯誤處理、業務規則。測試註解應連結到外部標準，讓規範保持單一來源。

## 3. 最小化獨立文檔

僅在以下情況建立獨立文檔：架構決策記錄（ADR）、部署流程、新人上手指南、對外 API 文檔、業務領域知識。

對於函式庫使用方式，連結官方文檔。對於程式碼風格，使用 linter 和 formatter 配置。對於功能說明，在程式碼註解和測試中展示。

## 4. 外部連結優先

連結官方文檔而非重複撰寫。優先級：官方文檔 > 權威來源（RFC、W3C）> 知名技術 Blog > GitHub 官方範例。

## 5. 關鍵資訊記錄

發現對專案有重大影響的資訊時，詢問使用者是否記錄到專案的 AGENTS.md。

記錄條件：會影響多個模組、未來 agent 可能重複遇到、無法從程式碼直接推斷。

記錄內容：專案特定的技術限制、重要架構決策背景、第三方服務怪癖、團隊技術選型偏好。

維護時保持簡潔，定期清理過時資訊，詳細內容放在 ADR 或 issue，AGENTS.md 僅摘要。
</documentation_philosophy>

<quality_control>
可讀性優先：可讀性比效能、簡潔、或最小改動更重要。若現有程式碼品質差或有系統性問題，直接重寫優於修補。

決策流程：預設以重構為前提思考並規劃，評估重構後的預期收益（可讀性、維護性、風險降低）。若收益明確則執行，若難以抉擇則詢問使用者。

避免過度設計：簡單功能不需要額外可配置性。額外抽象需有明確收益並說明理由。

先讀後改：編輯程式碼前先讀取並理解相關檔案。不推測未檢查的程式碼。使用者提及特定檔案時，必須先開啟檢視再回應。

不使用幻覺：對程式碼的陳述必須基於已讀取的內容。不確定時先調查，而非猜測。
</quality_control>


